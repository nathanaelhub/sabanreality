document.addEventListener("DOMContentLoaded",function(){const e=document.querySelector(".nav-toggle"),t=document.querySelector(".nav-menu"),r=document.querySelector(".nav-close"),o=document.querySelectorAll(".nav-link");e&&e.addEventListener("click",()=>{t.classList.add("active"),document.body.style.overflow="hidden"}),r&&r.addEventListener("click",()=>{t.classList.remove("active"),document.body.style.overflow=""}),o.forEach(e=>{e.addEventListener("click",()=>{t.classList.remove("active"),document.body.style.overflow=""})});const n=document.querySelector(".navbar");function s(){window.scrollY>100?n.classList.add("scrolled"):n.classList.remove("scrolled")}window.addEventListener("scroll",s),s();const a=document.querySelector(".scroll-top");a&&(window.addEventListener("scroll",()=>{window.scrollY>500?a.classList.add("active"):a.classList.remove("active")}),a.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})})),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){const t=document.querySelector(this.getAttribute("href"));if(t){e.preventDefault();const r=t.offsetTop-80;window.scrollTo({top:r,behavior:"smooth"})}})});const c=document.querySelectorAll(".fade-in"),l=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("visible"),l.unobserve(e.target))})},{threshold:.1,rootMargin:"0px 0px -50px 0px"});c.forEach(e=>l.observe(e));const i=document.querySelector(".filter-bar"),d=document.querySelector(".property-grid");if(i&&d){const k=document.getElementById("propertyType"),x=document.getElementById("bedrooms"),C=document.getElementById("priceRange"),T=document.getElementById("searchInput");function u(){const e=d.querySelectorAll(".property-card"),t=k?.value||"all",r=x?.value||"all",o=C?.value||"all",n=T?.value.toLowerCase()||"";e.forEach(e=>{const s=e.dataset.type||"",a=e.dataset.bedrooms||"",c=parseInt(e.dataset.price)||0,l=e.querySelector(".property-title")?.textContent.toLowerCase()||"",i=e.querySelector(".property-location")?.textContent.toLowerCase()||"";let d=!0;if("all"!==t&&s!==t&&(d=!1),"all"!==r&&a!==r&&(d=!1),"all"!==o){const[e,t]=o.split("-").map(e=>parseInt(e)||1/0);(c<e||c>t)&&(d=!1)}!n||l.includes(n)||i.includes(n)||(d=!1),e.style.display=d?"block":"none"});const s=d.querySelectorAll('.property-card[style="display: block;"], .property-card:not([style*="display"])'),a=document.querySelector(".no-results");if(0===s.length){if(!a){const e=document.createElement("div");e.className="no-results",e.innerHTML="<p>No properties found matching your criteria. Try adjusting your filters.</p>",d.appendChild(e)}}else a&&a.remove()}k?.addEventListener("change",u),x?.addEventListener("change",u),C?.addEventListener("change",u),T?.addEventListener("input",u)}function m(e,t){e.classList.add("error");const r=document.createElement("span");r.className="error-message",r.textContent=t,r.style.cssText="color: #e07a5f; font-size: 0.875rem; margin-top: 0.25rem; display: block;",e.parentNode.appendChild(r)}function p(e){e.classList.remove("error");const t=e.parentNode.querySelector(".error-message");t&&t.remove()}function y(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function v(e){const t=document.createElement("div");t.className="form-success",t.innerHTML='\n      <div style="background: #27ae60; color: white; padding: 1rem; border-radius: 8px; margin-top: 1rem; text-align: center;">\n        <strong>Thank you!</strong> Your message has been sent successfully. We\'ll get back to you soon.\n      </div>\n    ',e.appendChild(t),setTimeout(()=>{t.remove()},5e3)}function f(e){const t=e.querySelector(".form-error");t&&t.remove();const r=document.createElement("div");r.className="form-error",r.innerHTML='\n      <div style="background: #e07a5f; color: white; padding: 1rem; border-radius: 8px; margin-top: 1rem; text-align: center;">\n        <strong>Something went wrong.</strong> Please try again or email us directly at jeffsabarealty@gmail.com\n      </div>\n    ',e.appendChild(r),setTimeout(()=>{r.remove()},7e3)}document.querySelectorAll("form[data-validate]").forEach(e=>{e.addEventListener("submit",function(t){t.preventDefault();let r=!0;e.querySelectorAll("[required]").forEach(e=>{var t;p(e),e.value.trim()?"email"!==e.type||y(e.value)?"tel"!==e.type||(t=e.value,/^[\d\s\-\+\(\)]{10,}$/.test(t))||(m(e,"Please enter a valid phone number"),r=!1):(m(e,"Please enter a valid email address"),r=!1):(m(e,"This field is required"),r=!1)}),r&&(v(e),e.reset())})});const h=document.querySelectorAll(".gallery-thumb"),g=document.querySelector(".gallery-main img");h.length&&g&&h.forEach(e=>{e.addEventListener("click",function(){const e=this.querySelector("img").src;g.src=e,h.forEach(e=>e.classList.remove("active")),this.classList.add("active")})});const b=document.querySelector(".theme-toggle");if(b){const A=localStorage.getItem("theme");A&&(document.documentElement.setAttribute("data-theme",A),E(A)),b.addEventListener("click",()=>{const e="dark"===document.documentElement.getAttribute("data-theme")?"light":"dark";document.documentElement.setAttribute("data-theme",e),localStorage.setItem("theme",e),E(e)})}function E(e){const t=document.querySelector(".theme-toggle svg");t&&(t.innerHTML="dark"===e?'<path d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>':'<path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>')}const S=document.getElementById("contactForm");S&&S.addEventListener("submit",async function(e){e.preventDefault();let t=!0;if(S.querySelectorAll("[required]").forEach(e=>{p(e),e.value.trim()?"email"!==e.type||y(e.value)||(m(e,"Please enter a valid email address"),t=!1):(m(e,"This field is required"),t=!1)}),!t)return;const r=S.querySelector('button[type="submit"]'),o=r.textContent;r.textContent="Sending...",r.disabled=!0;try{const e=new FormData(S),t=await fetch("https://formsubmit.co/ajax/jeffsabarealty@gmail.com",{method:"POST",body:e});(await t.json()).success?(v(S),S.reset()):f(S)}catch(e){f(S)}finally{r.textContent=o,r.disabled=!1}});const w=document.querySelector(".newsletter-form");w&&w.addEventListener("submit",async function(e){e.preventDefault();const t=this.querySelector('input[type="email"]');if(!t||!y(t.value))return;const r=this.querySelector('button[type="submit"]'),o=r.textContent;r.textContent="Subscribing...",r.disabled=!0;try{const e=new FormData;e.append("email",t.value),e.append("_subject","New Newsletter Subscriber - Saban Realty"),e.append("_template","table");const n=await fetch("https://formsubmit.co/ajax/jeffsabarealty@gmail.com",{method:"POST",body:e});(await n.json()).success?this.innerHTML='<p style="color: #27ae60; font-weight: 600;">Thank you for subscribing!</p>':(r.textContent=o,r.disabled=!1,f(this))}catch(e){r.textContent=o,r.disabled=!1,f(this)}});const L=document.querySelectorAll("img[data-src]");if("IntersectionObserver"in window){const I=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const t=e.target;t.src=t.dataset.src,t.removeAttribute("data-src"),I.unobserve(t)}})});L.forEach(e=>I.observe(e))}else L.forEach(e=>{e.src=e.dataset.src});const q=window.location.pathname.split("/").pop()||"index.html";document.querySelectorAll(".nav-link").forEach(e=>{const t=e.getAttribute("href");(t===q||""===q&&"index.html"===t)&&e.classList.add("active")})});const propertyData={properties:[]};